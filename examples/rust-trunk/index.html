<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SymEngine Rust+Trunk Demo</title>
    <link data-trunk rel="rust" data-wasm-opt="z" />
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 640px;
            margin: 2rem auto;
            padding: 0 1rem;
            color: #1a1a1a;
        }
        h1 { margin-bottom: 0.5rem; }
        p.subtitle { color: #666; margin-bottom: 1.5rem; }
        label { display: block; font-weight: 600; margin-top: 1rem; }
        input, select {
            width: 100%;
            padding: 0.5rem;
            margin-top: 0.25rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
        }
        button {
            margin-top: 1rem;
            padding: 0.5rem 1.5rem;
            background: #2563eb;
            color: #fff;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
        }
        button:hover { background: #1d4ed8; }
        #result {
            margin-top: 1rem;
            padding: 1rem;
            background: #f5f5f5;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            min-height: 2rem;
        }
        #version { margin-top: 2rem; color: #999; font-size: 0.85rem; }
    </style>
</head>
<body>
    <h1>SymEngine + Rust + Trunk</h1>
    <p class="subtitle">Symbolic math in the browser via <code>wasm32-unknown-unknown</code></p>

    <label for="expr">Expression</label>
    <input id="expr" type="text" value="x**3 + 2*x**2 + x" placeholder="e.g. sin(x)*cos(x)" />

    <label for="var">Variable</label>
    <input id="var" type="text" value="x" placeholder="e.g. x" />

    <label for="op">Operation</label>
    <select id="op">
        <option value="diff">Differentiate</option>
        <option value="expand">Expand</option>
        <option value="latex">To LaTeX</option>
    </select>

    <button id="run">Compute</button>

    <div id="result"></div>
    <div id="version"></div>

    <script type="module">
        import init, { differentiate, expand, to_latex, symengine_version_str } from './pkg/symengine_rust_trunk.js';

        async function main() {
            await init();

            document.getElementById('version').textContent =
                'SymEngine ' + symengine_version_str();

            document.getElementById('run').addEventListener('click', () => {
                const expr = document.getElementById('expr').value;
                const v = document.getElementById('var').value;
                const op = document.getElementById('op').value;
                const out = document.getElementById('result');

                try {
                    if (op === 'diff') {
                        out.textContent = differentiate(expr, v);
                    } else if (op === 'expand') {
                        out.textContent = expand(expr);
                    } else {
                        out.textContent = to_latex(expr);
                    }
                } catch (e) {
                    out.textContent = 'Error: ' + e;
                }
            });
        }
        main();
    </script>
</body>
</html>
